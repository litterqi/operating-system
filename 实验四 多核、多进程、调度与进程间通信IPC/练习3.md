# 答案解读：
函数位于oslab4\kernel\sched\policy_rr.c中
## rr_sched_enqueue()
```
if (thread == NULL || thread->thread_ctx == NULL || thread->thread_ctx->state == TS_READY) {
                return -EINVAL;
        }
        if (thread->thread_ctx->type == TYPE_IDLE) {
                return 0;
        }
        u32 cpu_id;
        if (thread->thread_ctx->affinity == NO_AFF)
                cpu_id = smp_get_cpu_id();
        else
                cpu_id = thread->thread_ctx->affinity;
        if (cpu_id >= PLAT_CPU_NUM)
                return -EINVAL;
        thread->thread_ctx->state = TS_READY;
        thread->thread_ctx->cpuid = cpu_id;
        list_append(&(thread->ready_queue_node), &(rr_ready_queue_meta[cpu_id].queue_head));
        ++rr_ready_queue_meta[cpu_id].queue_len;
```

## rr_sched_dequeue()
```
if (thread == NULL || thread->thread_ctx == NULL || thread->thread_ctx->state != TS_READY)
                return -EINVAL;
        list_del(&(thread->ready_queue_node));
        --rr_ready_queue_meta[thread->thread_ctx->cpuid].queue_len;
        thread->thread_ctx->state = TS_INTER;
```

## rr_sched_choose_thread()
```
u32 cpu_id = smp_get_cpu_id();
        thread = list_entry(rr_ready_queue_meta[cpu_id].queue_head.next, struct thread, ready_queue_node);
        if (rr_sched_dequeue(thread))
                return &idle_threads[cpu_id];
```

## rr_sched()
```
struct thread *cur = current_thread;
        if (cur && cur->thread_ctx && cur->thread_ctx->type != TYPE_IDLE) {
                if (current_thread->thread_ctx->sc->budget > 0 && current_thread->thread_ctx->state != TS_WAITING 
                        && cur->thread_ctx->thread_exit_state != TE_EXITING) {
                        return 0;
                }

                if (cur->thread_ctx->thread_exit_state == TE_EXITING) {
                        cur->thread_ctx->state = TS_EXIT;
                        cur->thread_ctx->thread_exit_state = TE_EXITED;
                }
                else if (cur->thread_ctx->state != TS_WAITING) {
                        rr_sched_enqueue(cur);
                }
        }

        cur = rr_sched_choose_thread();
        rr_sched_refill_budget(cur, DEFAULT_BUDGET);
        switch_to_thread(cur);
```
