# 答案解读：
相关函数位于oslab4\kernel\semaphore\semaphore.c中
## wait_sem()
```
if (sem->sem_count == 0) {
                if (is_block) {
                        current_thread->thread_ctx->state = TS_WAITING;
                        list_append(&(current_thread->sem_queue_node), &(sem->waiting_threads));
                        ++sem->waiting_threads_count;
                        obj_put(sem);
                        sched();
                        eret_to_thread(switch_context());
                } else ret = -EAGAIN;
        }
else --sem->sem_count;
```
## signal_sem()
```
if (sem->waiting_threads_count > 0) {
                struct thread *awake = list_entry(sem->waiting_threads.next, struct thread, sem_queue_node);
                list_del(&awake->sem_queue_node);
                --sem->waiting_threads_count;
                sched_enqueue(awake);
        }
else ++sem->sem_count;
```
